= Getting Started
:revnumber: 1.0 
:revdate: 31.03.2020
:imagesdir: images

In this tutorial we will go through all the steps, neccesary to set up your work environment.
In this walktrough we will cover the installation of git, vscode and the set up with asciidoc.
so that in the end you are ready to go with and can start working on the .adoc files.

TIP: Don't worry all tools are free and opensource.

== Downloads and Tools

Lets get started with the installation of git.

please download the appropriate distribution for your system from here:
https://git-scm.com/downloads

a Basic git tutorial you can find here : https://www.youtube.com/watch?v=SWYqp7iY_Tc["git tutorial"]

For windows this is a regualr installer, this will install a very simple git GUI and the git bash. On the git website there is also a collection of 3rd Party git clients available.

git tutorials you can find here: https://git-scm.com/doc

after you installed git you should be able to find the git bash, this looks like this:

image::git_bash.png[img1, 500, title="git bash"]

We will need this bash later, now please install VS Code, you can find the free download here:
https://code.visualstudio.com/

also please install the AsciiDoc Extension, the guide how to install this extension you will find in the below link:

https://marketplace.visualstudio.com/items?itemName=joaompinto.asciidoctor-vscode


TIP: If you want to have a live preview of what your paper you ware working looks like, 
check out the Asciidoc extension for Chrome: https://chrome.google.com/webstore/detail/asciidoctorjs-live-previe/iaalpfgpbocpdfblpnhhgllgbdbchmia


== Setup Workenvironment

First of all we need to creat an SSH key, with this you do not need to enter your credentials with every commit/push.

=== 1. First generate the SSH key:
To create a new SSH key pair:

Open a terminal on Linux or macOS, or Git Bash / WSL on Windows.

For Windows User please open your File Explorer and navigate to the folder where the future repository shall be.
To open the Git Bash, just just the context Menu (right click) in the file Explorer

image::open_git_bash.png[open_git, 500, titel="open git bash"]

once the git bash is opened you can already see that the bash is set to the correct folder, +
in this case: ``C:\MyWorkspace\30_ascii_docs\Repository``

image::git_bash4.png[git, 500, titel="git bash"]

to insert copied commands from this tutorial, the usual "Ctrl + C" and "Ctrl + V" will not work, instead you can still use "Crtl + C", to copy the commands to the clipboard and than paste the command into the terminal, by using either the context menu or the "insert"-button on your keyboard

image::ins_git_bash.png[ins_git, 500, titel="git bash insert copied commands"]

Now lets get back to the SSH key generation...

*Generate a new ED25519 SSH key pair:*

    ssh-keygen -t ed25519 -C "email@example.com"

Or, if you want to use RSA:

    ssh-keygen -t rsa -b 4096 -C "email@example.com"

The -C flag adds a comment in the key in case you have multiple of them
and want to tell which is which. It is optional.


Next, you will be prompted to input a file path to save your SSH key pair to.
If you don't already have an SSH key pair and aren't generating a deploy key,
use the suggested path by pressing "Enter". Using the suggested path will normally allow your SSH client to automatically use the SSH key pair with no additional configuration.
If you already have an SSH key pair with the suggested file path, you will need
to input a new file path and declare what host
this SSH key pair will be used for in your ~/.ssh/config file.


Once the path is decided, you will be prompted to input a password to
secure your new SSH key pair. It's a best practice to use a password,
but it's not required and you can skip creating it by pressing
"Enter" twice.

NOTE: Please note when entering your password, this will not be displayed in the terminal and also the cursor will not move while typing

If, in any case, you want to add or change the password of your SSH key pair,
you can use the -p flag:

    ssh-keygen -p -f <keyname>

=== 2. Add the SSH key to your GitLab Account

Copy your public SSH key to the clipboard by using one of the commands below
depending on your Operating System:

macOS:

    pbcopy < ~/.ssh/id_ed25519.pub

WSL / GNU/Linux (requires the xclip package):

    xclip -sel clip < ~/.ssh/id_ed25519.pub

Git Bash on Windows: 

    cat ~/.ssh/id_ed25519.pub | clip

You can also open the key in a graphical editor and copy it from there,
but be careful not to accidentally change anything.

NOTE: If you opted to create an RSA key, the name might differ.


Add your public SSH key to your GitLab account by:

Clicking your avatar in the upper right corner and selecting Settings.

image::git_add_ssh_key1.png[img2, 1100, title="GitLab Settings"]

Navigating to SSH Keys and pasting your public key in the Key field. If you:

Created the key with a comment, this will appear in the Title field.
Created the key without a comment, give your key an identifiable title like Work Laptop or Home Workstation.


Click the Add key button.

NOTE: If you manually copied your public SSH key make sure you copied the entire
key starting with ssh-ed25519 (or ssh-rsa) and ending with your email.

image::git_add_ssh_key2.png[img3, 1100, title="GitLab add SSH Key"]

=== 3. Testing that everything is set up correctly
To test whether your SSH key was added correctly, run the following command in
your terminal:

    ssh -T git@code.asam.net

The first time you connect to GitLab via SSH, you will be asked to verify the
authenticity of the GitLab host you are connecting to.
For example, when connecting to GitLab.com, answer yes to add GitLab.com to
the list of trusted hosts:

    The authenticity of host 'gitlab.com (35.231.145.151)' can't be established.
    ECDSA key fingerprint is SHA256:HbW3g8zUjNSksFbqTiUWPWg2Bq1x8xdGUrliXFzSnUw.
    Are you sure you want to continue connecting (yes/no)? yes
    Warning: Permanently added 'gitlab.com' (ECDSA) to the list of known hosts.

NOTE: For GitLab.com, consult the SSH host keys fingerprints, to make sure you're connecting to the correct server. Once added to the list of known hosts, you won't be asked to validate the authenticity of GitLab's host again. Run the above command once more, and you should only receive a Welcome to GitLab, @username! message. If the welcome message doesn't appear, run SSH's verbose mode by replacing -T with -vvvT to understand where the error is.

if everything worked fine it can look similar to this:

image::git_bash2.png[img4, 500, title="GitLab SSH check"]

== Setting up your local repository

To set up your local repository open the git bash in the folder where you want to have your repository. You can do so by using you context menu. enter the following line in the bash (see the above steps in the key generating section):

    git clone git@code.asam.net:simulation/opendrive.git

If the clone was successful it looks like this:

image::git_bash3.png[img5, 500, title="GitLab SSH check"]

Now we need to open this repository with our install Editor - in case of this tutorial VS-Code
To do so, please start VS-Code:

image::vscode2.png[img61, 600, title="Visual Studio Code"]

Now use the "open folder" command to open the cloned repository. Once the repsoitory is loaded into VS-Code the integraded source control will also enable you to pull and commit to the ASAM Gitlab. 

There are a few extensions that will help you get along with the source control and ascii-doc. +
Please install the following two extensions to VS-Code:

. AsciiDoc
. Git Graph

Go to the Extension Menu (marked as `1` in the image below) and search (marked as `2`) for the two mentioned extensions

image::vscode_ext.png[img61, 600, title="Visual Studio Code Extension"]

Now your work environment is set up. 

image::vscode1.png[img6, 1100, title="Visual Studio Code"]

By default your local repository will always be clone from the master-branch, as explaned in the <<Workflow_Tutorial.adoc>> you need to create your own branch to work on the concept paper. You can do so either using the git bash

TIP: If you want to have a live preview of what your paper you ware working looks like, 
check out the Asciidoc extension for Chrome: https://chrome.google.com/webstore/detail/asciidoctorjs-live-previe/iaalpfgpbocpdfblpnhhgllgbdbchmia
This is also available for other browsers

=== Switch to a other branch on your local copy

IMPORTANT: Please make sure to use pull the latest updates from the repository before switching branches, otherwise you could run into trouble on your local system due to file conflicts.

==== Switch Branch using the git bash

    git fetch origin # update your local copy with all changes in the remote version
    git checkout -b "BRANCH_NAME" "origin/BRANCHNAME" # switch to the branch 

==== Switch Branch using Git Graph

To use Git Graph switch to the integrated Source Control of VS-Code and activate Git Graph (top left side, marked in the image below). +
Now select a desired branch and open the Context Menu to use the "Checkout Branch" command, now your local repository is changed to that branch.

image::git_graph.png[img62, 900, title="using Git Graph"]


=== Commit / Push / Pull

Make any changes. Once you are ready to share them, upload them to the remote

==== Git Bash to Commit / Push / Pull
git bash commands to commit and push changes

    git add . # add your changes to the tracked versioning of git
    git commit -m "<SHORT MESSAGE DETAILING CHANGES>" # this message will be visible to anyone
    git push # push or upload the changes you made to the remote version of the branch you are on

to pull the latest changes, open the git bash in the repository folder (or change into the folder in the bash)

    git pull

==== Git Commit / Push / Pull using VS-Code

to commit the changes in VS-Code, change to the source control (using the side bar), here you will find a list of changed files. +
Please select all the files you want to commit (this is called staging). When hovering over the file with the mouse the "+" Button will appear, use this to stage.
When hovering over the "CHANGES" Column you can stage all the changes

image::stage_changes.png[stage, 500, title="stage all changes"]

Now enter your commit message, and use the "checkmark"-Button to complete your commit

image::commit.png[commit, 500, title="add commit message"]

The last step in the process is to upload/push your commit(s). So far all your changes are only locally on your system. Open the menu for the source control, using the three points "...". Here you can find the commands "Push" and also "Pull".

image::push.png[push, 500, title="source control menu"]

Now other project members will be able to review and comment on your changes


Once everyone is happy with the changes, the merge request will be accepted and the changes made will be integrated with the master branch, deleting the originally merged branch and closing the request & associated issues.

Only project members with the role of "maintainer" can accept merge requests onto the master branch - these are decided on in project meetings. Get in touch with an ASAM rep if you want to apply for this role.